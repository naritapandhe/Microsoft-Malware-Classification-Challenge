from subprocess import Popen, PIPE

#settings:
X_train = "./data/X_train_small.txt"
X_test = "./data/X_test_small.txt"
AWS_ACCESS_KEY_ID = 'AKIAJNFUBSR36COMCZMA'
AWS_SECRET_ACCESS_KEY = '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'

#set env variables
process = Popen(['export', 'AWS_ACCESS_KEY_ID=%s' % AWS_ACCESS_KEY_ID], stdout=PIPE, stderr=PIPE)
stdout, stderr = process.communicate()
process = Popen(['export', 'AWS_SECRET_ACCESS_KEY=%s' % AWS_SECRET_ACCESS_KEY], stdout=PIPE, stderr=PIPE)
stdout, stderr = process.communicate()

#download files from s3
with open(X_train,'r') as f:
    filenames = f.readlines() 

for i in xrange(len(filenames)):
    print 'copying file %i of %i: %s' % (i+1,len(filenames),filenames[i])
    process = Popen(['aws', 's3', 'cp', 's3://eds-uga-csci8360/data/project2/binaries/%s.bytes' % filenames[i][:-2],\
        '/data/binaries/%s.bytes'% filenames[i][:-2]], stdout=PIPE, stderr=PIPE)
    stdout, stderr = process.communicate()
